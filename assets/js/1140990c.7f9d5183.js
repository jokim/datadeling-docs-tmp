"use strict";(self.webpackChunkprod=self.webpackChunkprod||[]).push([[7351],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return m}});var r=t(7294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,r,l=function(e,n){if(null==e)return{};var t,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var s=r.createContext({}),d=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=d(e.components);return r.createElement(s.Provider,{value:n},e.children)},f={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},k=r.forwardRef((function(e,n){var t=e.components,l=e.mdxType,a=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),k=d(t),m=l,u=k["".concat(s,".").concat(m)]||k[m]||f[m]||a;return t?r.createElement(u,o(o({ref:n},p),{},{components:t})):r.createElement(u,o({ref:n},p))}));function m(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var a=t.length,o=new Array(a);o[0]=k;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:l,o[1]=i;for(var d=2;d<a;d++)o[d]=t[d];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}k.displayName="MDXCreateElement"},3198:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return i},contentTitle:function(){return s},metadata:function(){return d},toc:function(){return p},default:function(){return k}});var r=t(7462),l=t(3366),a=(t(7294),t(3905)),o=["components"],i={description:"Om responsen fra et API inneholder informasjon som er beskyttelsesverdig og som ikke alle konsumenter trenger kan man legge p\xe5 en enkel policy som fjerner felt fra responsen.\n\n\nOm der er et eget-utviklet API er det bedre \xe5 endre i APIet. Og selv om man ikke kan endre p\xe5 et API: er det\xa0 behov for st\xf8rre endringer i responsen til et API er det oftest bedre \xe5 gj\xf8re dette utenfor API manageren, feks. ved \xe5 ha en liten mikrotjeneste mellom API manager og backend-APIet.\n\n\nMen mindre endringer, f.eks. for \xe5 fjerne enkelte felt, er policy-en\xa0 JSON to JSON transformation en rask og enkel m\xe5te \xe5 filtere bort innhold man vil beskytte",title:"Filtrere bort innhold i responsen fra et API"},s="Filtrere bort innhold i responsen fra et API",d={unversionedId:"datadeling/veiledere/api-manager/filtrere-innhold-json",id:"datadeling/veiledere/api-manager/filtrere-innhold-json",isDocsHomePage:!1,title:"Filtrere bort innhold i responsen fra et API",description:"Om responsen fra et API inneholder informasjon som er beskyttelsesverdig og som ikke alle konsumenter trenger kan man legge p\xe5 en enkel policy som fjerner felt fra responsen.\n\n\nOm der er et eget-utviklet API er det bedre \xe5 endre i APIet. Og selv om man ikke kan endre p\xe5 et API: er det\xa0 behov for st\xf8rre endringer i responsen til et API er det oftest bedre \xe5 gj\xf8re dette utenfor API manageren, feks. ved \xe5 ha en liten mikrotjeneste mellom API manager og backend-APIet.\n\n\nMen mindre endringer, f.eks. for \xe5 fjerne enkelte felt, er policy-en\xa0 JSON to JSON transformation en rask og enkel m\xe5te \xe5 filtere bort innhold man vil beskytte",source:"@site/docs/datadeling/veiledere/api-manager/filtrere-innhold-json.md",sourceDirName:"datadeling/veiledere/api-manager",slug:"/datadeling/veiledere/api-manager/filtrere-innhold-json",permalink:"/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/filtrere-innhold-json",editUrl:"https://github.com/jokim/datadeling-docs-tmp/tree/gh-pages/docs/datadeling/veiledere/api-manager/filtrere-innhold-json.md",version:"current",frontMatter:{description:"Om responsen fra et API inneholder informasjon som er beskyttelsesverdig og som ikke alle konsumenter trenger kan man legge p\xe5 en enkel policy som fjerner felt fra responsen.\n\n\nOm der er et eget-utviklet API er det bedre \xe5 endre i APIet. Og selv om man ikke kan endre p\xe5 et API: er det\xa0 behov for st\xf8rre endringer i responsen til et API er det oftest bedre \xe5 gj\xf8re dette utenfor API manageren, feks. ved \xe5 ha en liten mikrotjeneste mellom API manager og backend-APIet.\n\n\nMen mindre endringer, f.eks. for \xe5 fjerne enkelte felt, er policy-en\xa0 JSON to JSON transformation en rask og enkel m\xe5te \xe5 filtere bort innhold man vil beskytte",title:"Filtrere bort innhold i responsen fra et API"},sidebar:"tutorialSidebar",previous:{title:"Caching i gravitee",permalink:"/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/caching-gravitee"},next:{title:"Godkjenne tilgang til API",permalink:"/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/godkjenne-tilgang-til-api"}},p=[],f={toc:p};function k(e){var n=e.components,i=(0,l.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},f,i,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"filtrere-bort-innhold-i-responsen-fra-et-api"},"Filtrere bort innhold i responsen fra et API"),(0,a.kt)("p",null,"Om responsen fra et API inneholder informasjon som er beskyttelsesverdig og som ikke alle konsumenter trenger kan man legge p\xe5 en enkel policy som fjerner felt fra responsen."),(0,a.kt)("p",null,"Om der er et eget-utviklet API er det bedre \xe5 endre i APIet. Og selv om man ikke kan endre p\xe5 et API: er det\xa0 behov for st\xf8rre endringer i responsen til et API er det oftest bedre \xe5 gj\xf8re dette utenfor API manageren, feks. ved \xe5 ha en liten mikrotjeneste mellom API manager og backend-APIet."),(0,a.kt)("p",null,"Men mindre endringer, f.eks. for \xe5 fjerne enkelte felt, er policy-en\xa0 JSON to JSON transformation en rask og enkel m\xe5te \xe5 filtere bort innhold man vil beskytte"),(0,a.kt)("p",null,"Legg p\xe5 policy-en JSON to JSON transformation. Om filtreringen skal gjelde alle som benytter APIet, ",(0,a.kt)("a",{parentName:"p",href:"/docs/datadeling/veiledere/api-manager/legge-pa-enkel-policy"},"legg p\xe5 policy som beskrevet her.")),(0,a.kt)("p",null,"Om filtreringen skal gjelde en enkel plan, slik at man kan ha en plan som gir all informasjon i svaret og en annen plan som kun gir \xe5pen informasjon i svar, legg p\xe5 policy-en i siste siden i veiviseren for \xe5 opprette/endre plan."),(0,a.kt)("p",null,'I nedtrekksmenyen hvor det st\xe5r "Choose a policy", velg JSON to JSON transformation og trykk ADD'),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Legge policy p\xe5 plan i gravitee",src:t(7516).Z}),"  "),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"json to json policy",src:t(7598).Z})),(0,a.kt)("p",null,"I Scope, velg RESPONSE."),(0,a.kt)("p",null,"I feltet for JOLT Spesification spesifiserer du hva som skal endres i JSONen."),(0,a.kt)("p",null,"Denne policy-en benytter ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/bazaarvoice/jolt"},"open source-prosjektet JOLT")),(0,a.kt)("p",null,"Det finnes en ",(0,a.kt)("a",{parentName:"p",href:"http://jolt-demo.appspot.com"},"web-side hvor man kan teste dette her")),(0,a.kt)("p",null,"Eksempel 1 p\xe5 en respons fra et API"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n{\n  "ansatt": {\n    "id": "00102099",\n    "brukerident": null,\n    "dfoBrukerident": null,\n    "eksternIdent": null,\n    "fornavn": "Kjell-Arne",\n    "etternavn": "Testesen",\n    "fnr": "29078729585",\n    "annenId": [\n      null\n    ],\n    "fdato": "1987-07-29"\n  }\n}\n')),(0,a.kt)("p",null,'For \xe5 fjerne n\xf8kkelel "fnr" og dens verdi konfigurer vi policy-en slik:'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n[\n  {\n    "operation": "remove",\n    "spec": {\n      "ansatt": {\n        "fnr": ""\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"Kaller man APIet etter at denne policy-en er lagt p\xe5, vil man f\xe5 denne responsen"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n{\n  "ansatt": {\n    "id": "00102099",\n    "brukerident": null,\n    "dfoBrukerident": null,\n    "eksternIdent": null,\n    "fornavn": "Kjell-Arne",\n    "etternavn": "Testesen",\n    "annenId": [\n      null\n    ],\n    "fdato": "1987-07-29"\n  }\n}\n')),(0,a.kt)("p",null,"Mange APIer gir enkelt-svar tilbake som et enkelt objekt, men kall som finner flere objekter gir tilbake en liste med objekter. For \xe5 filtrere bort fnr fra denne:"),(0,a.kt)("p",null,"Eksempel 2"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n{\n\xa0 "ansatt": [\n\xa0\xa0\xa0 {\n\xa0\xa0\xa0\xa0\xa0 "id": "00102099",\n\xa0\xa0\xa0\xa0\xa0 "brukerident": null,\n\xa0\xa0\xa0\xa0\xa0 "dfoBrukerident": null,\n\xa0\xa0\xa0\xa0\xa0 "eksternIdent": null,\n\xa0\xa0\xa0\xa0\xa0 "fornavn": "Kjell-Arne",\n\xa0\xa0\xa0\xa0\xa0 "etternavn": "Testesen",\n\xa0\xa0\xa0\xa0\xa0 "annenId": [\n\xa0\xa0\xa0\xa0\xa0\xa0\xa0 null\n\xa0\xa0\xa0\xa0\xa0 ],\n\xa0\xa0\xa0\xa0\xa0 "fdato": "1987-07-29"\n\xa0\xa0\xa0 },\n\xa0\xa0\xa0 {\n\xa0\xa0\xa0\xa0\xa0 "id": "00100982",\n\xa0\xa0\xa0\xa0\xa0 "brukerident": null,\n\xa0\xa0\xa0\xa0\xa0 "fornavn": "Martin",\n\xa0\xa0\xa0\xa0\xa0 "etternavn": "Martinsen",\n\xa0\xa0\xa0\xa0\xa0 "fnr": "23456789",\n\xa0\xa0\xa0\xa0\xa0 "fdato": "1973-11-06"\n\xa0\xa0\xa0 }\n\xa0 ]\n}\n')),(0,a.kt)("p",null,"kan f\xf8lgende spesifisering benyttes:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n[\n  {\n    "operation": "remove",\n    "spec": {\n      "ansatt": {\n        "*": {\n          "fnr": ""\n        },\n        "fnr": ""\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"Den vil fungere b\xe5de p\xe5 det f\xf8rste og andre eksemplet"),(0,a.kt)("p",null,"Eksempel 3"),(0,a.kt)("p",null,"Noen ganger vil man kun returnere svar ut i fra en verdi i svaret. Gitt at APIet gir f\xf8lgende respons:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n{\n\xa0 "id": "5001234",\n\xa0 "navn": "Ola Nordmann",\n\xa0 "info": "Informasjon som noen ganger er unntatt offentligheten",\n\xa0 "unntattOff": "False"\n}\n\n')),(0,a.kt)("p",null,'og vi vil returnere denn responen, men ikke om feltet "unntattOff" er "True"'),(0,a.kt)("p",null,"Denne JOLT-spesifikasjonen vil kun tillate svar der hvor\xa0 svaret er False"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n[\n  {\n    "operation": "shift",\n    "spec": {\n      "unntattOff": {\n        "False": {\n          "@2": ""\n        }\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"Om responsen fra APIet er som f\xf8lger"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n{\n  "id": "5001234",\n  "navn": "Ola Nordmann",\n  "info": "Dette er hemmelig",\n  "unntattOff": "True"\n}\n')),(0,a.kt)("p",null,"vil svaret fra Gravitee med denne policy-en p\xe5 planen/APIet v\xe6re"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"\nnull\n")),(0,a.kt)("p",null,'Merk at slik som vi har laget JOLT-spesifikasjonen s\xe5 tar vi med svaret om UnntattOff er False. Om det har verdien "Nei" eller er tomt vil det ikke bli tatt med. Det er og mulig \xe5 erstatte inholdet med en tom verdi om UnntattOff er True, og returnere svar om det har en hvilken som helst annen verdi (eller ingen verdi), men da risikerer man i returnere svar som ikke skulle v\xe6rt med om\xa0 UnntattOff ved feil eller kodeendring er tomt, f\xe5r verdien "Ja" eller endret stor/liten bokstav til TRUE eller true.'),(0,a.kt)("p",null,'Merk at denne ikke vil returnere svar om n\xf8kkelen "unntattOff" mangler helt.'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n[\n  {\n    "operation": "shift",\n    "spec": {\n      "unntattOff": {\n        "true": {\n          "": ""\n        },\n        "*": { "@2": "" }\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"Eksempel med default-verdi"),(0,a.kt)("p",null,'Om en n\xf8kkel kun er med n\xe5r det har en verdi vil ikke dette eksempele fungere. Feks. om "unntattOff" kun er med i svaret om det har verdien "true" eller om det kun er med om noen eksplisitt har valgt "true" eller "false". I disse tilfelene vil ingen av konfigurasjonene i dette eksempelet fungere. Det man kan gj\xf8re er \xe5 sette en default-verdi f\xf8rst, og deretter shift-operasjonen:'),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n[\n  {\n    "operation": "default",\n    "spec": {\n      "unntattOff": "false"\n    }\n  },\n  {\n    "operation": "shift",\n    "spec": {\n      "unntattOff": {\n        "true": {\n          "": ""\n        },\n        "*": { "@2": "" }\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"Merk at n\xf8kkel/verdien som blir lagt til vil bli med i svaret som g\xe5r til mottakeren"),(0,a.kt)("p",null,"Eksemplene over vil (i likhet med eksempel 1) ikke fungere om man f\xe5r liste med svar. For slike tilfeller kan man bruke:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n[\n  {\n    "operation": "shift",\n    "spec": {\n      "unntattOff": {\n        "false": {\n          "@2": ""\n        }\n      },\n      "*": {\n        "unntattOff": {\n          "false": {\n            "@2": ""\n          }\n        }\n      }\n    }\n  }\n]\n')),(0,a.kt)("p",null,"For \xe5 sette inn defeult-verdier i en array m\xe5 det spesifiseres at det er en array ved \xe5 legge p\xe5 [] i slutten av navnet."),(0,a.kt)("p",null,"f eks."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n{\n  "ressurser": \n [\n  {\n   "id": "5001234",  \n   "navn": "Kari Nordmann",  \n   "info": "Informasjon  er unntatt offentligheten",  \n   "unntattOff": "True"\n  },\n  {\n   "id": "5001235",\n   "navn": "Ola Nordmann",\n   "info": "Informasjon som ikke er unntatt offentligheten"\n  }\n ]\n}\n')),(0,a.kt)("p",null,"Bruk"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'\n[\n    {\n    "operation": "default",\n    "spec": {\n      "ressurser[]":{\n        "*":{\n          "unntattOff": "false"\n        }\n      }\n    }\n  },\n  {\n    "operation": "shift",\n    "spec": {\n      "ressurser":{\n        "*": {\n          "unntattOff": {\n            "false": {\n              "@2": "ressurser"\n            }\n          }\n        }\n      }\n    }\n  }\n]\n')))}k.isMDXComponent=!0},7516:function(e,n,t){n.Z=t.p+"assets/images/image-20210126164247-1-48c560105fdefac59e243e2f5fef8fd9.png"},7598:function(e,n,t){n.Z=t.p+"assets/images/image-20210126175724-2-16f06cdebfd5a9918c6566f76271318b.png"}}]);