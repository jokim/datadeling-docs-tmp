"use strict";(self.webpackChunkdatadeling=self.webpackChunkdatadeling||[]).push([[4712],{3905:function(e,n,t){t.d(n,{Zo:function(){return k},kt:function(){return p}});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var o=r.createContext({}),d=function(e){var n=r.useContext(o),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},k=function(e){var n=d(e.components);return r.createElement(o.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},g=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,o=e.parentName,k=l(e,["components","mdxType","originalType","parentName"]),g=d(t),p=a,c=g["".concat(o,".").concat(p)]||g[p]||u[p]||i;return t?r.createElement(c,s(s({ref:n},k),{},{components:t})):r.createElement(c,s({ref:n},k))}));function p(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,s=new Array(i);s[0]=g;var l={};for(var o in n)hasOwnProperty.call(n,o)&&(l[o]=n[o]);l.originalType=e,l.mdxType="string"==typeof e?e:a,s[1]=l;for(var d=2;d<i;d++)s[d]=t[d];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}g.displayName="MDXCreateElement"},8165:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return o},metadata:function(){return d},toc:function(){return k},default:function(){return g}});var r=t(7462),a=t(3366),i=(t(7294),t(3905)),s=["components"],l={description:"For av API gatewayen skal kunne snakke med APIet p\xe5 backend-serveren m\xe5 API-gatewayen som oftest autentisere seg.",title:"Konfigurere backend"},o="Konfigurere backend",d={unversionedId:"datadeling/veiledere/api-manager/backend",id:"datadeling/veiledere/api-manager/backend",isDocsHomePage:!1,title:"Konfigurere backend",description:"For av API gatewayen skal kunne snakke med APIet p\xe5 backend-serveren m\xe5 API-gatewayen som oftest autentisere seg.",source:"@site/docs/datadeling/veiledere/api-manager/backend.md",sourceDirName:"datadeling/veiledere/api-manager",slug:"/datadeling/veiledere/api-manager/backend",permalink:"/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/backend",editUrl:"https://github.com/facebook/docusaurus/edit/master/website/docs/datadeling/veiledere/api-manager/backend.md",version:"current",frontMatter:{description:"For av API gatewayen skal kunne snakke med APIet p\xe5 backend-serveren m\xe5 API-gatewayen som oftest autentisere seg.",title:"Konfigurere backend"},sidebar:"tutorialSidebar",previous:{title:"Forvaltning av tilganger til API",permalink:"/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/api-tilganger"},next:{title:"Caching i gravitee",permalink:"/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/caching-gravitee"}},k=[{value:"Autentisering med API-n\xf8kkel eller brukernavn/passord",id:"autentisering-med-api-n\xf8kkel-eller-brukernavnpassord",children:[]},{value:"F\xe5 alle requests fra samme IP-adresse",id:"f\xe5-alle-requests-fra-samme-ip-adresse",children:[]},{value:"Token-basert",id:"token-basert",children:[]},{value:"Sertifikater",id:"sertifikater",children:[]}],u={toc:k};function g(e){var n=e.components,l=(0,a.Z)(e,s);return(0,i.kt)("wrapper",(0,r.Z)({},u,l,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"konfigurere-backend"},"Konfigurere backend"),(0,i.kt)("p",null,"For av API gatewayen skal kunne snakke med APIet p\xe5 backend-serveren m\xe5 API-gatewayen som oftest autentisere seg."),(0,i.kt)("p",null,"${resource:toc}"),(0,i.kt)("p",null,'For \xe5 konfigurere hvordan API Gatewayen skal koble seg til APIet i bak-kant gj\xf8r man det under "Backend services endpoint"'),(0,i.kt)("p",null,'Naviger til ditt API, deretter Proxy, Endpoints (under Backend services" og trykk p\xe5 tannhjulet'),(0,i.kt)("p",null,(0,i.kt)("img",{src:t(3014).Z})),(0,i.kt)("p",null,"Om du har flere backend-servere som skal ha ulik konfigurasjon er det ogs\xe5 mulig. Bruk da tannhjuet som st\xe5r etter det aktuelle backend-serveren eller opprett flere grupper."),(0,i.kt)("h3",{id:"autentisering-med-api-n\xf8kkel-eller-brukernavnpassord"},"Autentisering med API-n\xf8kkel eller brukernavn/passord"),(0,i.kt)("p",null,"API-n\xf8kkel eller brukernavn/passord legges som oftest inn som HTTP-header"),(0,i.kt)("p",null,(0,i.kt)("img",{src:t(8568).Z})),(0,i.kt)("p",null,"Trykk p\xe5 det lysegra +tegnet for \xe5 legge til en header. Fyll inn hva headeren heter og verdien (n\xf8kkelen). Er det en annen gravitee-installasjon i bak-kant vil det f.eks. v\xe6re slik:"),(0,i.kt)("p",null,(0,i.kt)("img",{src:t(9324).Z})),(0,i.kt)("p",null,'Andre systemer kaller ofte headeren noe annet, f.ekss bare "X-API-Key"'),(0,i.kt)("p",null,'Ved bruk av"Basic auth" autentiserer man med brukernavn/passord. Navnet p\xe5 headeren er Authorization og inneholder teksten Basic + mellomrom + brukernavn/passord. Brukernavnet og passordet legges inn som en base64-encodet streng, skilt med : (kolon).'),(0,i.kt)("p",null,"Det finnes mange verkt\xf8y for \xe5 skifte mellom vanlig tekst og base64, i linux kan man f.eks. bruke f\xf8lgende kommando i en terminalvindu:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"\necho -n brukernavn:passord | base64\n")),(0,i.kt)("p",null,"Man kan sjekke at det ble riktig ved \xe5 bruke :"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"\necho YnJ1a2VybmF2bjpwYXNzb3JkCg== | base64 -d\n")),(0,i.kt)("p",null,"For dette eksempelet vil det se slik ut i Gravitee:"),(0,i.kt)("p",null,(0,i.kt)("img",{src:t(5581).Z})),(0,i.kt)("h3",{id:"f\xe5-alle-requests-fra-samme-ip-adresse"},"F\xe5 alle requests fra samme IP-adresse"),(0,i.kt)("p",null,"Gravitee er installert p\xe5 en kubernetes-kluster. De kan derfor kj\xf8re p\xe5 hvilken som helst\xa0 server i clusteret og clusteret kan endre seg (utvides/erstattes). I tillegg kj\xf8rer vi alltid med minst 2 gateway-er for \xe5 unng\xe5 nedetid. API Gatewayen vil derfor kunne ha forskjellig ip-adresser. Mange backend-servicer ligger p\xe5 sperrede nett eller \xe5pner kun for enkelt-IP-adresser. For \xe5 slippe \xe5 eksponere backend-services mer enn n\xf8dvendig kan man konfigurere et API til \xe5 bruke en HTTP-proxy. Requesten vil da f\xf8rst g\xe5 til proxy-serveren og proxy-serveren ruter deretter requesten til riktig server. For backend-serveren ser det ut som requesten kom fra ip-adressen til proxy-serveren."),(0,i.kt)("p",null,"For \xe5 kunne gj\xf8re dette m\xe5 man ha en proxy-server. Denne b\xf8r v\xe6re sikret slik at ikke alle kan bruke denne, f.eks. kan den sikres med brukernavn og passord, og kun tillate din bruker \xe5 kontakte den aktuelle backend-serveren."),(0,i.kt)("p",null,"Proxy-konfigurasjon gj\xf8res og\xe5 under HTTP-konfiguration. Huk av for HTTP proxy og fyll inn n\xf8dvedig informasjon"),(0,i.kt)("p",null,(0,i.kt)("img",{src:t(2168).Z})),(0,i.kt)("h3",{id:"token-basert"},"Token-basert"),(0,i.kt)("p",null,"Ved token-basert autentisering menes som oftest autentisering med Java web tokens (JWTs). Disse er oftest kort-levede og m\xe5 generesres med jevne mellomrom, f.eks. hver time eller hvert ti-ende minutt. De kan ogs\xe5 v\xe6re for engangsbruk. Som oftest m\xe5 man lage et\xa0 en-gangs-token, kontakte en Authorization Server med dette en-gangs-tokenet og man f\xe5r tilbake et token som er gyldig i en kort stund."),(0,i.kt)("p",null,"Dette er for komplisert til \xe5 kunne konfigurere her. Dette gj\xf8res ved hjelp av policies eller et annet API."),(0,i.kt)("p",null,"Dette h\xf8res komplisert ut, men er b\xe5de sikkert og fleksibelt."),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"/prosjekter/datadeling/arbeidsomrader/integrasjonsarkitektur/dokumentasjon/veiledere/api-manager/jwt-mot-backend.html"},"Se egen veiledning")),(0,i.kt)("h3",{id:"sertifikater"},"Sertifikater"),(0,i.kt)("p",null,"Gateway-en kan autentisere seg med klient-sertifikat. Dette er (som token-basert autentisering) mye sikrere enn ved bruk av API-n\xf8kkel eller brukernavn/passord. Konfigureres under"),(0,i.kt)("p",null,"SSL - Client Authentication\n","[TODO-",">"," teste dette]","\nFyll inn type sertificat (PKCS#12,PFX, Java key store/PEM-sertifikat/n\xf8kkel-par) samt lim inn sertifikat-fila (eller path til denne om den er gjort tilgjengelig p\xe5 filsystemet til API gateway-en) og evt. passord"))}g.isMDXComponent=!0},3014:function(e,n,t){n.Z=t.p+"assets/images/image-20200925142430-1-e390af33c79d4aa15b9a20cbf9f83f7b.png"},8568:function(e,n,t){n.Z=t.p+"assets/images/image-20200925143000-3-ebd909ae9fec8fa0d83deed818a7cd5e.png"},9324:function(e,n,t){n.Z=t.p+"assets/images/image-20200925143832-4-13f671bd710e11b21d7a44dfef345f6e.png"},5581:function(e,n,t){n.Z=t.p+"assets/images/image-20200925145447-5-1fc3f9fc0515577f1958b2ccd6167ed0.png"},2168:function(e,n,t){n.Z=t.p+"assets/images/image-20200925151029-6-d5f22fc89bd1165759a3d050342a3f70.png"}}]);