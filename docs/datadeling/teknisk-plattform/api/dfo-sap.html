<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<title data-rh="true">DFØ SAP | Datadeling Test</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/dfo-sap"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="DFØ SAP | Datadeling Test"><meta data-rh="true" name="description" content="Hjelp til oppsett av DFØ SAP sine REST API."><meta data-rh="true" property="og:description" content="Hjelp til oppsett av DFØ SAP sine REST API."><link data-rh="true" rel="icon" href="/datadeling-docs-tmp/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/dfo-sap"><link data-rh="true" rel="alternate" href="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/dfo-sap" hreflang="en"><link data-rh="true" rel="alternate" href="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/dfo-sap" hreflang="x-default"><link rel="stylesheet" href="/datadeling-docs-tmp/assets/css/styles.d37e78f4.css">
<link rel="preload" href="/datadeling-docs-tmp/assets/js/runtime~main.ff4aa181.js" as="script">
<link rel="preload" href="/datadeling-docs-tmp/assets/js/main.32c6fdb5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/datadeling-docs-tmp/"><div class="navbar__logo"><img src="/datadeling-docs-tmp/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/datadeling-docs-tmp/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Datadeling</b></a><a class="navbar__item navbar__link navbar__link--active" href="/datadeling-docs-tmp/docs/intro">Dokumentasjon</a></div><div class="navbar__items navbar__items--right"><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/datadeling-docs-tmp/docs/intro">Test av dokumentasjonen til prosjekt Datadeling</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/datadeling-docs-tmp/docs/datadeling">datadeling</a><button aria-label="Toggle the collapsible sidebar category &#x27;datadeling&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/begreper">begreper</a><button aria-label="Toggle the collapsible sidebar category &#x27;begreper&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/erfaringer">erfaringer</a><button aria-label="Toggle the collapsible sidebar category &#x27;erfaringer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/faq">Spørsmål og svar</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/god-praksis">god-praksis</a><button aria-label="Toggle the collapsible sidebar category &#x27;god-praksis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/kode">Kode som bruker IntArk</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/malgrupper/anskaffer">malgrupper</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/om">om</a><button aria-label="Toggle the collapsible sidebar category &#x27;om&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/prinsippene">Integrasjonsprinsippene for IntArk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/styringsregler">Styringsreglene til IntArk</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform">teknisk-plattform</a><button aria-label="Toggle the collapsible sidebar category &#x27;teknisk-plattform&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/oversikt">Oversikt over den tekniske plattformen</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/dfo-sap">api</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/dfo-sap">DFØ SAP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/fs">Felles Studentsystem - FS-API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/inspera">Inspera</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/integra">Integra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/maskinporten">Maskinporten som token-tjeneste i Gravitee</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/brom">Selvbetjening for RabbitMQ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/gravitee">Gravitee</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/infrastruktur">Infrastrukturen til IntArks tekniske plattform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/prosessene">Prosessene for teknisk plattform</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/rabbitmq">RabbitMQ</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/unntak">Unntakshåndtering</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere">veiledere</a><button aria-label="Toggle the collapsible sidebar category &#x27;veiledere&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/">🏠</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/docs/datadeling">datadeling</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform">teknisk-plattform</a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">api</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/dfo-sap">DFØ SAP</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>DFØ SAP</h1><p>Hjelp til oppsett av DFØ SAP sine REST API.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="om-api-ene">Om API-ene<a class="hash-link" href="#om-api-ene" title="Direct link to heading">​</a></h2><p>DFØs løsninger for økonomi og lønn brukes av mange i sektoren. DFØ tilbyr API som er felles for sektoren, men der hver institusjon får ut sine data.</p><p>DFØ tilbyr flere ulike API-er for ulike data, som ansattinformasjon, stillingsdata og organisasjonsdata. Se <a href="https://api-portal.dfo.no/" target="_blank" rel="noopener noreferrer">DFØs API-portal</a> for mer informasjon.</p><p>TODO: For å kunne bruke DFØs API må din institusjon bli &quot;oppgradert&quot; hos DFØ. Mange institusjoner må i dag forholde seg til CSV-filer fra DFØ. Dette må gjøres i dialog med DFØ, og dette vil kunne ta tid.</p><p>DFØ krever autentisering via
<a href="https://samarbeid.digdir.no/maskinporten/maskinporten/25" target="_blank" rel="noopener noreferrer">Maskinporten</a> i sin
kommunikasjon, så institusjonen må registrere seg der før integrasjonen kan
påbegynnes. Maskinporten bruker sertifikater for autentisering, så
institusjonen må ha virkssomhetssertifikat tilgjengelig, enten for å bruke det
direkte til autentisering eller for å laste opp privat serfifikat som brukes av
den enkelte integrasjon. Mot produksjonsystem brukes det vanlige
virksomhetsertifikatet og mot test brukes testsertifikat.</p><p>Som de fleste andre APIene settes APIet opp med autentisering mot vår API gateway, og deretter sendes requesten videre til backend-APIet. I API gatewayen legger vi på token og evt. API-nøkkel som brukes mot DFØs APIer. Tjenesten som utsteder token kan enten settes opp i Gravitee (<a href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/maskinporten">se bruksanvisning her</a>) eller hos den enkelte institusjon</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="standardoppsett">Standardoppsett<a class="hash-link" href="#standardoppsett" title="Direct link to heading">​</a></h2><p>DFØ er en fellestjeneste, og må/bør derfor settes opp likt hos alle institusjoner. Du kan sette dette opp ved å laste inn fil med standardoppsett:</p><p><a target="_blank" href="/datadeling-docs-tmp/assets/files/Lonnssystem-api-template-3b2bbc90b455917361224b662f1b4e3e.json">Lonnssystem-api-template.json</a></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="hvordan-sette-opp-api-ene">Hvordan sette opp API-ene<a class="hash-link" href="#hvordan-sette-opp-api-ene" title="Direct link to heading">​</a></h2><ol><li>Registrer din institusjon hos Maskinporten, <a href="https://samarbeid.digdir.no/maskinporten/konsument/119" target="_blank" rel="noopener noreferrer">se planleggingsaktiviteten her</a>. Registrer deretter en integrasjon i maskinporten, se veiledning her(<a href="https://docs.digdir.no/docs/Maskinporten/maskinporten_sjolvbetjening_web.html" target="_blank" rel="noopener noreferrer">https://docs.digdir.no/docs/Maskinporten/maskinporten_sjolvbetjening_web.html</a>) Sluttresultatet er at du har en integrasjon hvor du kan autentisere vha. virksomhetssertifikat eller et sertifikat du har laget selv (og som bare brukes mot denne integrasjonen) Integrasjonen må ha blitt tildelt de nødvendige scopes og du må ha issuer-ID tilgjengelig</li><li>Opprett tokentjeneste om du ikke har gjort det tidligere og gi APIet tilgang.<ul><li>Om du vil lage en i gravitee <a href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/maskinporten">se veiledning her</a> Gi deretter SAP-APIet tilgang ved å opprette en applikasjon for dette og søk om tilgang til maskinporten-APIet. Når tilgangen er gitt får du en API-nøkkel som vi bruker i neste steg</li></ul></li><li>Last ned standardoppsettet over, og opprett tjenesten i API manager. Se <a href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/importer-api">veileder for å registrere en tjeneste i API manager via fil</a>.<ol><li>Gå inn i APIet og endre på Navn og beskrivelse</li><li>Gå til proxy -<!-- -->&gt;<!-- --> Entrypoint og evt. endre dette</li><li>Hvis prod: gå inn på proxy -<!-- -->&gt;<!-- --> backend services. Fjern &quot;-test&quot; fra URLen slik at det står <a href="https://api.dfo.no" target="_blank" rel="noopener noreferrer">https://api.dfo.no</a></li><li>Klikk på Design og policy-en HTTP Callout. Endre URL til den til tokentjenesten. Endre headeren X-Gravitee-Api-Key til nøkkelen fra punkt 2 om du har satt opp maskinporten-API i API Manager. Under headeren iss legger du inn ISSUER-ID for maskinporten-integrasjonen. Om du kjører token-tjenesten selv, konfigurer sikker autentisering og evt. headere/parametre etter behov.</li></ol></li><li>Registrer DFØ SAP som tjeneste i <em>Selvbetjeningsportalen for RabbitMQ</em> (se <a href="/datadeling-docs-tmp/docs/datadeling/veiledere/meldingskø/opprett-tjeneste">veileder for å registrere tjenesten</a>). Hent ut tilkoblingsdetaljene som det blir opplyst om.<ul><li>Om DFØ skal publisere meldinger direkte til deres rabbitmq, Send med tilkoblingsdetaljene for publisering av notifikasjoner fra selvbetjeningsportalen. Passordet bør sendes på andre måter enn via e-post.</li><li>Om dere heller vil hente meldinger fra rabbitmq hos DFØ (eller en annen rabbitmq-installasjon) gjøres det vel å sette opp en shovel i rabbitMQ. Det finnes flere oppskrifter på hvordan man setter opp shovel. Her er oppskrift på en måte man kan sette det opp i rabbitMQ, mens man fremdeles gjør tilgangsstyring i BROM. Dette krever ekstra tilganger i rabbitMQ for å gjøre nødvendig oppsett.<ol><li><p>Registrer applikasjon i BROM. Velg at den skal publisere meldinger. Velg et godt navn og beskrivelse, dette er applikasjonen som utviklere abonnerer på om de vil ha meldinger fra deres SAP-installasjon</p></li><li><p>(Valgfritt) For å lett kunne se om shovel-en fungerer kan du opprette en applikasjon som abonnerer på meldinger fra applikasjonen du opprettet i forrige punkt. Godkjenn denne. Når shovelen fungerer vil det komme meldinger inn i meldingskøen for denne applikasjonen. Merk: denne bør slettes i ettertid.</p></li><li><p>Om IntArk-koordinator ikke har nødvendige rettigheter i rabbitMQ fra før,  kontakt support som oppretter bruker med nødvendinge rettigheter.</p></li><li><p>Sørg for å ha tilkoblingsinformasjon (brukernavn, passord, vhost, kø-navn, hostnavn) tilgjengelig</p></li><li><p>Logg inn i rabbitMQ med bruker som har rettigheter til å opprette shovel. I BROM er det link til innloggingsiden her: <img loading="lazy" alt="applikasjonsinfo i BROM" src="/datadeling-docs-tmp/assets/images/image-20211006190506-1-76008a2e1ddd40fbd524c65ba3682e6c.png" width="1143" height="671"></p></li><li><p>Naviger til siden &quot;Admin&quot; og undemenyen &quot;Shovel Management&quot; <img loading="lazy" alt="webside for Shovel management i rabbitmq" src="/datadeling-docs-tmp/assets/images/rabbitmq-shovel-1-a1ca366ec6382f9218019e3e4f4b160a.png" width="1247" height="809"></p></li><li><p>Under Add shovel, fyll ut:</p><ul><li>Velg vhost med samme navn som applikasjonen i punkt 1 (ikke nødvendig, men gjør det lettere å holde oversikt senere)</li><li>Gi et godt navn</li><li>Under source så er protocol nesten alltid AMQP 0.9.1, så det kan stå</li><li>source URI: adresse for å koble seg på DFØs rabbitmq riktig. Denne er litt komplisert. Den skal være amqps://BRUKERNAVN:<a href="mailto:PASSORD@mq.dfo.no" target="_blank" rel="noopener noreferrer">PASSORD@mq.dfo.no</a>/VHOST  </li></ul><p><em>TIPS: lag denne i notepad eller annen tekstbehandler og bruk klipp og lim for å fylle inn i rabbitMQ. Feltet for dette i RabbitMQ er for kort til å se evt. feil</em></p><ul><li>source queue: navn på kø</li><li>destination URI: her er det samme rabbimtmq som vi er logget inn på, så denne er lettere Fyll inn amqp:///VHOST (hvor vhost er navnet på applikasjonen fra punkt 1) <em>OBS: merk at det er 3 skråstreker!</em></li><li>Endre fra queue til exchange</li><li>fyll inn navn på exchange. Det er outgoing<!-- -->_<!-- -->APPLIKASJONSNAVN (altså outgoing + underscore + navn på appliasjon. Du kan og se det under tilkoblingsdetaljer på publiseringsiden i brom)</li><li>routing key: La denne være blank. (Da vil meldingene beholde routing key som de har i kilden. Om du setter en verdi her til denne verdien overskrive eksisterende routing key) </li><li>Til sist trykk på &quot;add shovel&quot; Gå til siden &quot;Shovel status&quot; og se at shovlen du har laget endrer status til Started. Om den ikke endrer seg fra Starting til Started ila. et par minutter: sjekk tilkoblingsdetaljene, slett shovelen og opprett på nytt</li></ul></li></ol></li></ul></li></ol><p>API-et og meldingshåndtering er nå satt opp.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="hvordan-verifisere-at-api-et-fungerer">Hvordan verifisere at API-et fungerer:<a class="hash-link" href="#hvordan-verifisere-at-api-et-fungerer" title="Direct link to heading">​</a></h3><ol><li><p>Opprett din egen klient (applikasjon) i API manager, om du ikke har dette allerede.</p></li><li><p>Be om tilgang til API-et.</p></li><li><p>Godkjenn tilgangen til API-et. Du har nå fått en egen API-nøkkel for din klient.</p></li><li><p>Bruk klientens API-nøkkel, og sjekk at du får hentet ut data:</p><ul><li>Med curl (husk å endre det som står i uthevet tekst):</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">curl --include -H &quot;X-Gravitee-Api-Key: **API-nøkkel**&quot; https://gw-**INSTANS**.intark.uh-it.no/**lonn**/v1/organisasjoner/v1/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>Med Powershell (husk å endre det som står i uthevet tekst):</li></ul><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$headers = @{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;Accept&#x27; = &#x27;application/json&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;X-Gravitee-Api-Key&#x27; = **API-nøkkel**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Invoke-WebRequest -Headers $headers -Uri &quot;https://gw-**INSTANS**.intark.uh-it.no/**lonn**/v1/organisasjoner/v1&quot;    </span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><ul><li>Hvis alt er ok kan du forvente å få tilbake noe som starter med &quot;HTTP 200&quot; og JSON-data.</li></ul></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/jokim/datadelingsdokumentasjon/tree/master/docs/datadeling/teknisk-plattform/api/dfo-sap.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/oversikt"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Oversikt over den tekniske plattformen</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform/api/fs"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Felles Studentsystem - FS-API</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#om-api-ene" class="table-of-contents__link toc-highlight">Om API-ene</a></li><li><a href="#standardoppsett" class="table-of-contents__link toc-highlight">Standardoppsett</a></li><li><a href="#hvordan-sette-opp-api-ene" class="table-of-contents__link toc-highlight">Hvordan sette opp API-ene</a><ul><li><a href="#hvordan-verifisere-at-api-et-fungerer" class="table-of-contents__link toc-highlight">Hvordan verifisere at API-et fungerer:</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 HK-dir, Unit, Uninett AS</div></div></div></footer></div>
<script src="/datadeling-docs-tmp/assets/js/runtime~main.ff4aa181.js"></script>
<script src="/datadeling-docs-tmp/assets/js/main.32c6fdb5.js"></script>
</body>
</html>