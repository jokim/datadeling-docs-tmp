<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<title data-rh="true">Konfigurere autentisering via maskinporten | Datadeling Test</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/maskinporten-autentisering"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Konfigurere autentisering via maskinporten | Datadeling Test"><meta data-rh="true" name="description" content="[Under utvikling: Anbefalingen vil endre seg, etter erfaringer med BOTT:√òL i 2021]


Hvordan du kan sette opp autentisering av ditt API via Maskinporten, n√•r du trenger √• snakke med API utenfor din organisasjon."><meta data-rh="true" property="og:description" content="[Under utvikling: Anbefalingen vil endre seg, etter erfaringer med BOTT:√òL i 2021]


Hvordan du kan sette opp autentisering av ditt API via Maskinporten, n√•r du trenger √• snakke med API utenfor din organisasjon."><link data-rh="true" rel="icon" href="/datadeling-docs-tmp/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/maskinporten-autentisering"><link data-rh="true" rel="alternate" href="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/maskinporten-autentisering" hreflang="en"><link data-rh="true" rel="alternate" href="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/maskinporten-autentisering" hreflang="x-default"><link rel="stylesheet" href="/datadeling-docs-tmp/assets/css/styles.d37e78f4.css">
<link rel="preload" href="/datadeling-docs-tmp/assets/js/runtime~main.f6e3b48d.js" as="script">
<link rel="preload" href="/datadeling-docs-tmp/assets/js/main.bee006d5.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/datadeling-docs-tmp/"><div class="navbar__logo"><img src="/datadeling-docs-tmp/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/datadeling-docs-tmp/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Datadeling</b></a><a class="navbar__item navbar__link navbar__link--active" href="/datadeling-docs-tmp/docs/intro">Dokumentasjon</a></div><div class="navbar__items navbar__items--right"><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/datadeling-docs-tmp/docs/intro">Test av dokumentasjonen til prosjekt Datadeling</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/datadeling-docs-tmp/docs/datadeling">datadeling</a><button aria-label="Toggle the collapsible sidebar category &#x27;datadeling&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/begreper">begreper</a><button aria-label="Toggle the collapsible sidebar category &#x27;begreper&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/erfaringer">erfaringer</a><button aria-label="Toggle the collapsible sidebar category &#x27;erfaringer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/faq">Sp√∏rsm√•l og svar</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/god-praksis">god-praksis</a><button aria-label="Toggle the collapsible sidebar category &#x27;god-praksis&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/kode">Kode som bruker IntArk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/kurs">kurs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/malgrupper/anskaffer">malgrupper</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/om">om</a><button aria-label="Toggle the collapsible sidebar category &#x27;om&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/prinsippene">Integrasjonsprinsippene for IntArk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/styringsregler">Styringsreglene til IntArk</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform">teknisk-plattform</a><button aria-label="Toggle the collapsible sidebar category &#x27;teknisk-plattform&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/unntak">Unntaksh√•ndtering i IntArk</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere">veiledere</a><button aria-label="Toggle the collapsible sidebar category &#x27;veiledere&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/annet/anskaffelse">annet</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/api-manager-be-om-tilgang">api-manager</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/api-manager-be-om-tilgang">F√• tilgang til et API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/api-manager-registrere-enkelt-api">Registrere et enkelt API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/api-tilganger">Forvaltning av tilganger til API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/backend">Konfigurere backend</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/caching-gravitee">Caching i gravitee</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/filtrere-innhold-json">Filtrere bort innhold i responsen fra et API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/godkjenne-tilgang-til-api">Godkjenne tilgang til API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/importer-api">Importer API-oppsett fra fil</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/jwt-mot-backend">Backend-autentisering med JWTs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/legge-pa-enkel-policy">Legge p√• en enkel policy (IP filter)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/maskinporten-autentisering">Konfigurere autentisering via maskinporten </a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/opprette-plan">Opprette plan</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/rettigheter-og-roller-i-api-manager">Rettigheter, roller og grupper i API Manager</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/rolle-internrevisjon">Egne roller i Gravitee (f.eks. for innsyn)</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/se-bruk-av-api">Se bruken av ditt API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/varsling-for-api-eiere">Varsling av nye subscriptions o.l.</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/innforing">Kom i gang med IntArk</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/meldingsk√∏/opprett-tjeneste">meldingsk√∏</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere/sjekkliste-innforing">Sjekkliste for innf√∏ring av IntArk</a></li></ul></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/">üè†</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/docs/datadeling">datadeling</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/docs/datadeling/veiledere">veiledere</a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link breadcrumbsItemLink_e5ie">api-manager</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/maskinporten-autentisering">Konfigurere autentisering via maskinporten </a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Konfigurere autentisering via maskinporten</h1><p>[Under utvikling: Anbefalingen vil endre seg, etter erfaringer med BOTT:√òL i 2021]</p><p>Hvordan du kan sette opp autentisering av ditt API via Maskinporten, n√•r du trenger √• snakke med API utenfor din organisasjon.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="bakgrunn">Bakgrunn<a class="hash-link" href="#bakgrunn" title="Direct link to heading">‚Äã</a></h3><p>Maskinporten kan brukes til sikker autentisering mot API p√• tvers av organisasjoner.</p><p>N√•r man bruker maskinporten autentiserer man seg f√∏rst mot maskinporten med et sertifikat. Som svar f√•r man et tilgans-token, som igjen brukes til autorisasjon i API Gatewayen.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="forutsetninger">Forutsetninger<a class="hash-link" href="#forutsetninger" title="Direct link to heading">‚Äã</a></h3><p>Det forutsettes at organisasjonen din er registrert som bruker av maskinporten og har f√•tt opprettet et prefiks.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="registrer-api-i-maskinporten">Registrer API i Maskinporten<a class="hash-link" href="#registrer-api-i-maskinporten" title="Direct link to heading">‚Äã</a></h3><p>F√∏rst m√• API-et registreres i maskinporten. Da opprettes det et scope. Et scope kan brukes til √• gi tilganger til ressurser i et eller flere API. Det anbefales √• ikke bruke samme scope for √• gi tilgang til ulike API.</p><p>I tillegg m√• de organisasjonene som skal f√• tilgang til API-et bli gitt tilgang. Dette kan gj√∏res b√•de f√∏r og etter at API-et er registrert i API Gateway.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="registrer-api-et">Registrer API-et<a class="hash-link" href="#registrer-api-et" title="Direct link to heading">‚Äã</a></h3><p>Om det ikke allerede er registrert. Om det ikke allerede er gjort finnes det <a href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/api-manager-registrere-enkelt-api">veiledning her</a>. Kom tilbake til denne siden n√•r planer skal opprettes.</p><p>Opprett plan med sikret med JWT</p><p>Et tilgans-token er en type token som kalles Java Web Token, forkortet JWT (uttales jot eller j√•t).</p><p>Opprett en ny plan ved √• g√• til API-et, velg Plans og trykk p√• plusstegnet</p><p><img loading="lazy" alt="webside for √• opprette planer" src="/datadeling-docs-tmp/assets/images/image-20200928124644-1-b1764559e7b57ce2198043795e54e56c.png" width="838" height="374"></p><p>Skriv inn navn og en beskrivelse av planen. G√• til neste side.</p><p>P√• siden for Secure, under Authentication velg JWT som Authentication type.</p><p><img loading="lazy" alt="Meny for vinduet Secure" src="/datadeling-docs-tmp/assets/images/image-20201012173900-1-6d0358441eec3fecdf17065005012149.png" width="1688" height="1205"></p><p>Videre skal f√∏lgende legges til under Configuration.
I menyen for <strong>Signature</strong> la RS256 v√¶re valgt (det er eneste som st√∏ttes av maskinporten p.t.).</p><p>I menyen <strong>JWKS Resolver</strong>, velg JWKS<!-- -->_<!-- -->URL.</p><p>I <strong>Resolver parameter</strong> skriv eller lim inn URL hvor API Gatewayen kan finne maskinportens offentlige sertifikat. I produksjon er dette <a href="https://maskinporten.no/jwk" target="_blank" rel="noopener noreferrer">https://maskinporten.no/jwk</a> , i test er det <a href="https://ver2.maskinporten.no/jwk" target="_blank" rel="noopener noreferrer">https://ver2.maskinporten.no/jwk</a> eller <a href="https://ver1.maskinporten.no/jwk" target="_blank" rel="noopener noreferrer">https://ver1.maskinporten.no/jwk</a> , alt etter hvilket testmilj√∏ man benytter.</p><p>Om du vil kunne bruke informasjon fra tokenet til flere sjekker og/eller i policyer, huk av for <strong>Extract JWT Claims</strong>.</p><p>Det er god praksis √• sjekke autorisasjonen som er gitt b√•de i API gateway og i selve API-et. Med mindre du ikke stoler p√• API-et eller det er for testing, lar du <strong>Propagate Authorization Header</strong> v√¶re huket av. Tilgangs-tokenet blir da sendt til backend-API-et, og samme eller en mer grundig sjekk av tokenet foretas der. Det vil og forhindre urettmessig tilgang til API-et dersom man sp√∏r backend-API-et direkte uten √• g√• via gatewayen.</p><p><strong>User claim</strong> fungerer ikke p.t. med maskinporten.</p><p><strong>Additional selection rules.</strong> Her kan det bli litt komplisert. Her kan man legge inn flere regler for √• v√¶re sikker p√• at riktig plan blir valgt. Om API-et kun skal brukes av et scope kan du legge inn en sjekk av scope her. Er man sikker p√• at tokenet kun vil inneholde dette scopet, bruk f.eks:</p><div class="codeBlockContainer_I0IT language-Text theme-code-block"><div class="codeBlockContent_wNvx Text"><pre tabindex="0" class="prism-code language-Text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^org:test$&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Vil man tillate at tokenet har andre scope i tilegg til det som gir tilgang til ditt API kan man bruke:</p><div class="codeBlockContainer_I0IT language-Text theme-code-block"><div class="codeBlockContent_wNvx Text"><pre tabindex="0" class="prism-code language-Text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test(\\s[a-z:\\s])?$&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Et litt mer avansert eksempel. Har man et API hvor man kan bli tildelt enten lese- og skriverettigheter, eller kun skrive- eller kun leserrettigheter.</p><p>Da kan man ha en plan for b√•de lese og skrivetilgang med denne ekstra regelen:</p><div class="codeBlockContainer_I0IT language-Text theme-code-block"><div class="codeBlockContent_wNvx Text"><pre tabindex="0" class="prism-code language-Text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test(\\s[a-z:\\s])?$&#x27; &amp;&amp; #context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test.write(\\s[a-z:\\s])?$&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Kun for skirvetilgang:</p><div class="codeBlockContainer_I0IT language-Text theme-code-block"><div class="codeBlockContent_wNvx Text"><pre tabindex="0" class="prism-code language-Text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test.write(\\s[a-z:\\s])?$&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Kun for lesetilgang:</p><div class="codeBlockContainer_I0IT language-Text theme-code-block"><div class="codeBlockContent_wNvx Text"><pre tabindex="0" class="prism-code language-Text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test(\\s[a-z:\\s])?$&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>Merk at i dette eksempelet betyr rekkef√∏lgen noe. Planer som krever to scope m√• v√¶re f√∏rst i lista over tilgjengelige planer. P√• siden med oversikt over planer kan rekkef√∏lgen endres.</p><p>Sjekke for flere grants</p><p>Det kan v√¶re tilfeller hvor man vil ha en plan per organisasjon. Det anbefales ikke om det er mange organisasjoner som skal ha tilgang, men det er mulig, og om det er et endelig lite antall er det overkommelig. For √• legge inn regler som sl√•r inn om det er riktig organisasjonsnummer og riktig scope:</p><div class="codeBlockContainer_I0IT language-Text theme-code-block"><div class="codeBlockContent_wNvx Text"><pre tabindex="0" class="prism-code language-Text codeBlock_jd64 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">#context.attributes[&#x27;jwt&#x27;].claims[&#x27;consumer&#x27;][&#x27;ID&#x27;] == &#x27;0192:987654321&#x27; &amp;&amp; #context.attributes[&#x27;jwt&#x27;].claims[&#x27;scope&#x27;] matches &#x27;^([a-z:\\s]\\s)?org:test(\\s[a-z:\\s])?$&#x27;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_wuS7 clean-btn">Copy</button></div></div><p>N√•r alt er fylt inn, trykk &quot;NEXT&quot;.</p><p>For √• legge inn rate-limit, kvoter, svartelisting, hvitelisting eller policy, , se <a href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/opprette-plan">veiledningen for planer</a>.</p><p>Husk at planen m√• publiseres f√∏r den kan tas i bruk.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="registrere-applikasjon">Registrere applikasjon<a class="hash-link" href="#registrere-applikasjon" title="Direct link to heading">‚Äã</a></h3><p>For at en applikasjon skal kunne bruke API-et m√• applikasjonen registreres b√•de i maskinporten og i Gravitee. F√∏rst m√• applikasjonen registreres som en integrasjon i maskinporten, og s√• m√• den <a href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/api-manager-be-om-tilgang">registreres i Gravitee</a> med den client<!-- -->_<!-- -->id som den ble tildelt i maskinporten. Deretter kan applikasjonen s√∏ke om tilgang til riktig plan og API. N√•r tilgang er tildelt kan API-et benyttes. Man bruker ikke API-n√∏kkel og trenger ikke hente ut denne.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/jokim/datadelingsdokumentasjon/tree/master/docs/datadeling/veiledere/api-manager/maskinporten-autentisering.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/legge-pa-enkel-policy"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Legge p√• en enkel policy (IP filter)</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/datadeling-docs-tmp/docs/datadeling/veiledere/api-manager/opprette-plan"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Opprette plan</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#bakgrunn" class="table-of-contents__link toc-highlight">Bakgrunn</a></li><li><a href="#forutsetninger" class="table-of-contents__link toc-highlight">Forutsetninger</a></li><li><a href="#registrer-api-i-maskinporten" class="table-of-contents__link toc-highlight">Registrer API i Maskinporten</a></li><li><a href="#registrer-api-et" class="table-of-contents__link toc-highlight">Registrer API-et</a></li><li><a href="#registrere-applikasjon" class="table-of-contents__link toc-highlight">Registrere applikasjon</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2022 HK-dir, Unit, Uninett AS</div></div></div></footer></div>
<script src="/datadeling-docs-tmp/assets/js/runtime~main.f6e3b48d.js"></script>
<script src="/datadeling-docs-tmp/assets/js/main.bee006d5.js"></script>
</body>
</html>