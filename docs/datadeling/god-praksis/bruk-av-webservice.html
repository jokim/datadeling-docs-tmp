<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.17">
<title data-rh="true">Webservice – hva og hvordan | Datadeling Test</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/god-praksis/bruk-av-webservice"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Webservice – hva og hvordan | Datadeling Test"><meta data-rh="true" name="description" content="UiOs nye integrasjonsarkitektur er basert på teknologi kalt **Webservice**. Dette dokumentet forklarer grunnen for dette teknologivalget, hvordan Webservice (WS) passer inn i arkitekturen og gir retningslinjer for hvordan man best realiserer en WS for sin tjeneste."><meta data-rh="true" property="og:description" content="UiOs nye integrasjonsarkitektur er basert på teknologi kalt **Webservice**. Dette dokumentet forklarer grunnen for dette teknologivalget, hvordan Webservice (WS) passer inn i arkitekturen og gir retningslinjer for hvordan man best realiserer en WS for sin tjeneste."><link data-rh="true" rel="icon" href="/datadeling-docs-tmp/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/god-praksis/bruk-av-webservice"><link data-rh="true" rel="alternate" href="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/god-praksis/bruk-av-webservice" hreflang="en"><link data-rh="true" rel="alternate" href="https://jokim.github.io//datadeling-docs-tmp/docs/datadeling/god-praksis/bruk-av-webservice" hreflang="x-default"><link rel="stylesheet" href="/datadeling-docs-tmp/assets/css/styles.d37e78f4.css">
<link rel="preload" href="/datadeling-docs-tmp/assets/js/runtime~main.e4845f73.js" as="script">
<link rel="preload" href="/datadeling-docs-tmp/assets/js/main.d6ed1a21.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/datadeling-docs-tmp/"><div class="navbar__logo"><img src="/datadeling-docs-tmp/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/datadeling-docs-tmp/img/logo.svg" alt="My Site Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">Datadeling</b></a><a class="navbar__item navbar__link navbar__link--active" href="/datadeling-docs-tmp/docs/intro">Dokumentasjon</a></div><div class="navbar__items navbar__items--right"><div class="toggle_S7eR toggle_TdHA toggleDisabled_f9M3"><div class="toggleButton_rCf9" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" class="toggleScreenReader_g2nN" aria-label="Switch between dark and light mode (currently light mode)"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_CW9Y"><nav class="menu thin-scrollbar menu_SkdO"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/datadeling-docs-tmp/docs/intro">Test av dokumentasjonen til prosjekt Datadeling</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" href="/datadeling-docs-tmp/docs/datadeling">datadeling</a><button aria-label="Toggle the collapsible sidebar category &#x27;datadeling&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/begreper">begreper</a><button aria-label="Toggle the collapsible sidebar category &#x27;begreper&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/erfaringer">erfaringer</a><button aria-label="Toggle the collapsible sidebar category &#x27;erfaringer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/faq">Spørsmål og svar</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/god-praksis">god-praksis</a><button aria-label="Toggle the collapsible sidebar category &#x27;god-praksis&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/god-praksis/api-design">api-design</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/god-praksis/bruk-av-webservice">Webservice – hva og hvordan</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/god-praksis/datakvalitet">datakvalitet</a><button aria-label="Toggle the collapsible sidebar category &#x27;datakvalitet&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/god-praksis/informasjonsforvaltning/api-tilganger">informasjonsforvaltning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/god-praksis/integrasjonsmonster">integrasjonsmonster</a><button aria-label="Toggle the collapsible sidebar category &#x27;integrasjonsmonster&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/god-praksis/notifikasjonsdesign">notifikasjonsdesign</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/kode">Kode som bruker IntArk</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/malgrupper/anskaffer">malgrupper</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/om">om</a><button aria-label="Toggle the collapsible sidebar category &#x27;om&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/prinsippene">Integrasjonsprinsippene for IntArk</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/styringsregler">Styringsreglene til IntArk</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/teknisk-plattform">teknisk-plattform</a><button aria-label="Toggle the collapsible sidebar category &#x27;teknisk-plattform&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/unntak">Unntakshåndtering</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0" href="/datadeling-docs-tmp/docs/datadeling/veiledere">veiledere</a><button aria-label="Toggle the collapsible sidebar category &#x27;veiledere&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/">🏠</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/docs/datadeling">datadeling</a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/docs/datadeling/god-praksis">god-praksis</a></li><li class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_e5ie" href="/datadeling-docs-tmp/docs/datadeling/god-praksis/bruk-av-webservice">Webservice – hva og hvordan</a></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Webservice – hva og hvordan</h1><p>UiOs nye integrasjonsarkitektur er basert på teknologi kalt <strong>Webservice</strong>. Dette dokumentet forklarer grunnen for dette teknologivalget, hvordan Webservice (WS) passer inn i arkitekturen og gir retningslinjer for hvordan man best realiserer en WS for sin tjeneste.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="hva-er-en-webservicews">Hva er en Webservice(WS)?<a class="hash-link" href="#hva-er-en-webservicews" title="Direct link to heading">​</a></h2><p>En <strong>Webservice</strong> (<strong>WS</strong>) er en del av en tjeneste eller system som tilbyr lese- og/eller skrivetilgang til tjenesten eller systemet vha. webbasert teknologi. En WS kan være en integrert del av tjenesten (heretter vil &quot;tjeneste&quot; dekke både system og tjeneste), en modul til tjenesten eller en løsrevet komponent som har et eget livsløp. Felles for alle variasjoner er at de gir et standardisert grensesnitt til å lese og/eller skrive data som ligger i tjenesten. </p><p>En WS tilbyr ett eller flere <a href="https://en.wikipedia.org/wiki/Application_programming_interface" target="_blank" rel="noopener noreferrer">API-er</a> som tilbyr funksjoner opp mot tjenesten. Funksjonene kan være nærmest hva som helst, men som regel er de av typen &quot;hent data fra kilden&quot;. </p><p><img loading="lazy" src="/datadeling-docs-tmp/assets/images/ws-forklart-cf592fdf5080d788babbbc4fed9e21a9.png" width="866" height="428">
<em>Konsumenter spør kildens WS om data. Flere konsumenter benytter den samme WS-en da WS-ens API tilbyr funksjonalitet som dekker alle konsumentenes behov.</em></p><h2 class="anchor anchorWithStickyNavbar_mojV" id="hva-er-hensikten">Hva er hensikten?<a class="hash-link" href="#hva-er-hensikten" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="dagens-situasjon">Dagens situasjon<a class="hash-link" href="#dagens-situasjon" title="Direct link to heading">​</a></h3><p>Hensikten med å gå over på en WS-basert integrasjonsarkitektur er primært å kvitte seg med flaskehalser i organisasjonen, samt forhindre dobbeltarbeid. Mange av UiOs integrasjoner er basert på en såkalt &quot;hub&amp;spoke&quot;-modell der datakilden er ansvarlig for å levere fra seg de data som en konsument trenger. Årsakene til at dette har blitt en så vanlig modell for integrasjon er mange, der de viktigste er:</p><ul><li>sikkerhet - kun de ansvarlige for kilden skal få tilgang til dataene i kilden</li><li>kompleksitet - kun de ansvarlige for kilden forstår datamodellen i kilden</li><li>sentralisering - som en følge av sentralisering av data så blir integrasjonene også sentraliserte</li><li>tradisjon - slik at man &quot;alltid&quot; gjort integrasjon</li></ul><p><img loading="lazy" src="/datadeling-docs-tmp/assets/images/hub-forklart-52d262e871601624628043e2b051502d.png" width="826" height="622">
Kilden er ansvarlig for å gi konsumentene data. Ofte gjøres dette ved at komponenter i kilden genererer filer som sendes til konsumenten<em>.</em></p><p>Det er store utfordringer knyttet til en slik &quot;hub&amp;spoke&quot;-modell. Sentralisering av data er et veldig fornuftig valg for å bekjempe dårlig datakvalitet og sikre en autoritativ kilde som konsumenter kan forholde seg til. Sentralisering av integrasjonene nyter ikke de samme godene:</p><ul><li>De tekniske ressursene tilknyttet kilden blir bundet opp i enkeltprosjekter, andre prosjekter må vente.</li><li>En endring ute i en konsument medfører at ressurser må endre på kilden.</li><li>Kilden må alltid ha mange tekniske ressurser tilknyttet for å klare arbeidsmengden.</li><li>Prosjekter får store skjulte kostnader fordi ressurser i kilden må gjøre integrasjonen.</li><li>Prosjekter blir forsinket da det sjelden er nok tekniske ressurser tilknyttet kilden og ingen andre enn disse ressursene kan gjøre integrasjonen.</li></ul><h3 class="anchor anchorWithStickyNavbar_mojV" id="en-ws-basert-modell">En WS-basert modell<a class="hash-link" href="#en-ws-basert-modell" title="Direct link to heading">​</a></h3><p>To av problemene som har medført at &quot;hub&amp;spoke&quot;-modellen har blitt så utbredt er sikkerhet og kompleksitet. Uten grensesnitt som adresserer disse problemene så vil det være vanskelig å gjøre en omfattende endring i hvordan UiO gjør integrasjon. Sikkerhetsproblemet består i hovedsak at systemeiere ikke vil tillate andre tilganger rett i databaser eller til API-er inne i tjenesten. Det er lite eller ingen tilgangskontroll så skal noen ha tilgang til noe så får de det til alt - gjerne også muligheten til å endre data. </p><p>Kompleksitetsproblemene er ofte at internt i en tjeneste så er data strukturert på en slik måte at de gir mening for systemeiere og ressurser tilknyttet tjenesten, men ikke utenforstående. Så selv om man gir tilgang til en kilde så betyr ikke det at konsumenten skjønner hva kilden tilbyr eller får gale data.</p><p>Dette kan løses som en del av WS-modellen:</p><p><img loading="lazy" src="/datadeling-docs-tmp/assets/images/ws-api-26664470ed7580077a1124c6c649b42d.png" width="844" height="598">
Kilden tilby et API som forenkler de interne datastrukturene til noe forståelig og funksjonelt for utenforstående. Konsumentene får kun tilgang til de funksjonene som avtales på forhånd.</p><p>Hvordan API-et utformes i WS-en vil adressere kompleksitetsproblemene som nevnt. Hvis konsumenter trenger å finne alle kontoer på UiO så kan API-et tilby en vasket liste der alle aktive konti som oppfyller kravene vises. Interne data, som ikke er interessante for andre enn systemeier, vises ikke. </p><p>Systemeier for kilden og de tekniske ressursene tilknyttet kilden vil være ansvarlige for å tilby et API som gir konsumenter de data som konsumentene trenger. I oppstart av WS-basert integrasjon vil kostnaden knyttet til integrasjon være likt med tidligere måter å integrere på. Det er når WS-en allerede tilbyr et rikt API at systemeier vil se gevinsten i mindre behov for å bruke ressurser på integrasjon – prosjektene vil selv kunne skaffe data gjennom WS-en. Prosjektene kan budsjettere med tid og ressurser for integrasjon uten at kilden er en flaskehals.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="api-manager">API manager<a class="hash-link" href="#api-manager" title="Direct link to heading">​</a></h3><p>En API manager, også kalt API gateway, er en tjeneste for å kontrollere og styre tilganger til API-er. Tjenesten sikrer at konsumenter er de de utgir seg for å være (autentisering) og holder rede på de tilganger konsumentene skal ha (autorisasjon).</p><p><img loading="lazy" src="/datadeling-docs-tmp/assets/images/api-tilgang-835639dd5dd1efdbfe267a8ed5868bb2.png" width="1092" height="424">
Kildens WS tilbyr en rekke datauttrekk i form av et API. API manager er tjenesten som tilgangsstyrer uttrekkene slik at konsumentene kun har tilgang til avtalte deler av API-et.</p><p>Ved å sentralisere tilgangsstyringen av API-er så høster vi en rekke fordeler:</p><ul><li>Ett sentralt punkt for tilgangsstyring<ul><li>bestilling av flere tilganger i flere API-er kun ett sted</li><li>forvaltning av tilganger i flere kilder kun ett sted</li></ul></li><li>Sentral oversikt over dataflyt<ul><li>bedre sikkerhet</li><li>oversikt over hele virksomheten</li></ul></li><li>Ett punkt for integrasjon<ul><li>konsumenter må ikke lete etter ulike API-er</li><li>konsumenter kan integrere en gang, ulike kilder gir tilgang</li></ul></li></ul><p><img loading="lazy" src="/datadeling-docs-tmp/assets/images/api-tilgang2-63ec649013a570f748f2341e0c1b95e3.png" width="1036" height="514">
Eksempel på en konsument som trenger data fra flere kilder. Konsumenten forholder seg kun til API manager. Mellom kildene og API manager forvalter systemeierne de faktiske tilgangene.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="meldingskø-mq">Meldingskø (MQ)<a class="hash-link" href="#meldingskø-mq" title="Direct link to heading">​</a></h3><p>En meldingskø (MQ) er en tjeneste som gir kilder mulighet til å sende beskjed om at data er endret. I gamle hub &amp; spoke-integrasjoner baserer man seg i stor grad på fulldumper – altså filer med alle data en konsument trenger. Dette er kostbart, sårbart og tregt. Med en meldingskø er tanken at en kilde sender ut en notifikasjon når data har endret seg, som er av interesse for konsumenter. Notifikasjonen er ikke nødvendigvis informasjonsbærende nok til at konsumenten kan foreta en endring, men forteller konsumenten at den må hente data på nytt for å sjekke egne data mot den autoritative kilden. Dette gjøres med en URL til den berørte enheten.</p><p><img loading="lazy" src="/datadeling-docs-tmp/assets/images/mq-flyt-d61a42ce065ae6cd07265e1b786e6561.png" width="1024" height="510">
Notifikasjoner sendes fra kildene inn til meldingskøen. Konsumentene velger selv hvilke notifikasjoner de ønsker å abonnere på. Konsumenten nede til høyre abonnerer på notifikasjoner fra alle tre kildene i eksemplet.</p><p>Notifikasjoner skal ikke inneholde utfyllende informasjon fordi man ønsker liberale regler rundt abonnement på notifikasjoner. Flyter fødselsnummer eller sensitiv informasjon i notifikasjoner så må tilgangskontrollen på notifikasjoner være strengt regulert. Er notifikasjonene kun en indikator på at noe har skjedd med en enhet så vil tilgangskontrollen kunne gjøres ene og alene mot WS-en.</p><p>MQ, som beskrevet i arkitekturen og i dette dokumentet, er en sentral tjeneste. Andre meldingskøer kan eksistere i virksomheten uten at de faller inn under arkitekturen. Sammenhengen mellom API manager, WS og MQ forklares lenger ned i dokumentet.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="hvem-må-haen-ws">Hvem må ha en WS?<a class="hash-link" href="#hvem-må-haen-ws" title="Direct link to heading">​</a></h2><p>Det er ikke slik at alle tjenester må ha en WS i den nye integrasjonsarkitekturen. Kravet om WS inntreffer hovedsaklig når en kilde sitter på data som andre tjenester vil lese og eller skrive. Har kilden svært få integrasjoner og dette ikke vil øke i fremtiden så vil integrasjonsarkitekturprinsippene heller ikke kreve en WS foran kilden. Det gir for lite avkastning på investeringen.</p><p>WS vil være enten påkrev eller svært nyttig der tjenesten er en autoritativ kilde for data som andre trenger innsyn i, eller der tjenesten fungerer som en del av en annen tjeneste. </p><h3 class="anchor anchorWithStickyNavbar_mojV" id="autoritativ-kilde">Autoritativ kilde<a class="hash-link" href="#autoritativ-kilde" title="Direct link to heading">​</a></h3><p>Mange av integrasjonene på UiO kommer av at tjenester trenger noe data fra en autoritativ kilde. Eksempler er lister av alle personer, konti eller grupper. Hva disse dataene brukes til videre er forskjellig, men likhetstrekkene for selve integrasjonen er så markant at man får store fordeler av å modernisere og standardisere prosessen.</p><p><img loading="lazy" src="/datadeling-docs-tmp/assets/images/ws-mq-sirkel-4bd045e962bb27a031ce3cb8a351aca0.png" width="814" height="434">
Kilden sender en notifikasjon til en meldingskø(MQ) som videresender denne til konsumenter som abonnerer på denne typen notifikasjoner. Notifikasjonen sier at konsumenten må hente data om en entitet for å se om endringen skal reflekteres i konsumenten.</p><p>En tenkt flyt i modellen over er:</p><ol><li>Kilde sender notifikasjon med innhold &quot;person 123 er endret&quot; til MQ som følge av at et telefonnummer er endret.</li><li>MQ videresender notifikasjonen til de konsumenter som abonnerer på denne typen notifikasjoner fra kilden.</li><li>Konsumenten får beskjed om at person 123 har en ukjent endring.</li><li>Konsumenten kontakter API manager, som styrer tilgangen til WS-en til kilden, for å spørre om personobjektet 123.</li><li>Alle kall til API manager, og som er forhåndsgodkjent, videresendes til WS-en.</li><li>WS-en returnerer personobjektet 123, med det oppdaterte telefonnummeret.</li><li>Konsumenten sammenligner nye og gamle data og oppdaterer telefonnummeret.</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="datalager">Datalager<a class="hash-link" href="#datalager" title="Direct link to heading">​</a></h3><p>Integrasjoner er ikke alltid det å flytte data fra A til B, altså replisering av data. Sammensatte tjenester der man utnytter en tjenesteorientert arkitektur vil kunne bygge på andre tjenester. Et eksempel på dette kan være at en tjeneste velger å integrere med en kilde med den hensikt å benytte kilden som en del av sitt datalager. Tjenesten kunne integrert som over og replisert data om f.eks. personer, grupper eller kalenderdata, men man kan også gå direkte til kilden (bokstavelig talt) og jobbe direkte på kildedataene.</p><p><img loading="lazy" src="/datadeling-docs-tmp/assets/images/datalager-7a148c7f255482d72e1b8b8a14c37025.png" width="566" height="810">
En tjeneste, bestående av et brukergrensesnitt, et logisk lag og en database, benytter en ekstern kilde som en del av sitt datalag.</p><p>I et slikt scenario så kan det være krav til WS-en i kilden om å tilby skrivemuligheter. Man kan se for seg at personpresentasjonen på UiOs nettsider vil være redigerbare for personer som er innlogget og disse dataene både hentes fra UiOs HR-system, samt blir skrevet tilbake hvis personen redigerer dem i presentasjonssidene. Dette gir strengere krav til oppetid og skalerbarhet i kilden og dens WS, men gevinsten er at selve tjenesten blir mindre og mindre kostbar – man oppdaterer kildedata direkte uten mellomlagring og ekstra kompleksitet dette medfører.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="hvordan-skalet-api-i-en-ws-se-ut">Hvordan skal et API i en WS se ut?<a class="hash-link" href="#hvordan-skalet-api-i-en-ws-se-ut" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="restful">RESTful<a class="hash-link" href="#restful" title="Direct link to heading">​</a></h3><p><a href="https://en.wikipedia.org/wiki/Representational_state_transfer" target="_blank" rel="noopener noreferrer">REST</a> er en metodikk for å sikre løse koblinger mellom to tjenester i en integrasjon. Begrepet misbrukes ofte om integrasjoner som benytter HTTP som den underliggende protokollen for integrasjonen, men REST er ikke begrenset til HTTP og må ikke bygges over HTTP. For å sikre at man ikke viderefører gamle, tett koblede integrasjoner i den nye integrasjonsarkitekturen, bør tjenesteeiere og -utviklere etterstrebe å lage grensesnitt som er så RESTfulsom mulig.</p><p>Så hva er RESTful? Det kan deles inn i fire nivåer, der det er opp til tjenesteeier og -utvikler å bestemme hvor RESTful API-et skal være. Anbefalt minimumsnivå er nivå 2.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="nivå-0-rpc-over-http">Nivå 0: RPC over HTTP<a class="hash-link" href="#nivå-0-rpc-over-http" title="Direct link to heading">​</a></h4><p>På dette nivået ligger REST API-er som ikke egentlig er REST. Man har implementert typiske <a href="https://en.wikipedia.org/wiki/Remote_procedure_call" target="_blank" rel="noopener noreferrer">RPC</a>-kall over HTTP og kaller dette REST. Det resulterende API-et blir spesialisert og lite gjenbrukbart. Typisk forsøker man å tilby funksjonalitet i API-et tatt helt bokstavlig fra en bestilling. Ønsker konsument en å hente fornavn på en person så lager man en funksjon for dette. Konsument to ønsker hele navnet så da lager man en ny funksjon. Konsument tre ønsker en liste med alle navnetyper, samt muligheten til å oppdatere navn så da lages det flere funksjoner for alt dette. Man ender opp med tette koblinger og lite til ingen gjenbruk. </p><h4 class="anchor anchorWithStickyNavbar_mojV" id="nivå-1-ressurser">Nivå 1: Ressurser<a class="hash-link" href="#nivå-1-ressurser" title="Direct link to heading">​</a></h4><p>På nivå 1 begynner man å omfavne RESTful. Isteden for spesialiserte kall for enhver handling som omhandler en ressurs eller entitet så samler man disse i en felles ressurs. I eksemplet med navn på en person fra nivå 0 så samler man navn under <strong>persons/mathiasm/names*</strong>.*Under dette området samler man de funksjoner som omhandler navn. Dette er en bedre løsning enn i nivå 0, men fortsatt utsatt for spesialiserte funksjoner og manglende gjenbruk. Det oppfordrer dog til en ressursdrevet (datadrevet) modell der ressurser i form av data bestemmer mer av strukturen på API-et heller enn en mer tilfeldig modell basert på hvem som spurte om hva når.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="nivå-2-http-verb">Nivå 2: HTTP verb<a class="hash-link" href="#nivå-2-http-verb" title="Direct link to heading">​</a></h4><p>På dette nivået har API-et modnet betraktelig. Om man implementerer et nivå 2 API så er ikke API-et fullt ut RESTful, men det er likevel av en slik kvalitet at det oppfyller kravene fra integrasjonsarkitekturen. Det vil være modulært, datadrevet og gjenbrukbart. Som de tidligere eksemplene med personnavn så vil HTTP-verbet bestemme operasjonen man gjør på navn. <strong>GET persons/mathiasm/names</strong> vil gi en liste URL-er med de navn som er registrert for personen &#x27;mathiasm&#x27;. GET på en av disse vil gi denne typen navn. En endring eller sletting gjøres med HTTP-verbene DELETE, POST eller PUT. Behovet for spesialiserte funksjoner blir minimalt da dataene selv representeres som ressurser og man kan lese og skrive til disse ressursene.</p><h4 class="anchor anchorWithStickyNavbar_mojV" id="nivå-3hypermedia-controlshateoas">Nivå 3: Hypermedia Controls/HATEOAS<a class="hash-link" href="#nivå-3hypermedia-controlshateoas" title="Direct link to heading">​</a></h4><p>For et ekte RESTful API så skal API-et i WS-en være den kontrollerende aktøren i integrasjonen. Dette vil si at i eksemplet med navn så vil utseendet på API-et endre seg i forhold til kontekst. For konsument 1, som kun skal hente fornavn på personer, så viser API-et kun dette. For konsument 3, som ønsker alle navnetyper, samt mulighet til å oppdatere navn, så vil kallet som returnerer listen også inkludere lenker til hvordan konsumenten kan oppdatere navn. For de navn som ikke finnes vil det bli sendt med lenker til hvor konsumenten kan opprette disse navnene. API-et gir fra seg informasjon om tilstanden på data og tilgangene konsumenten har til data. Dette gir navn til det velklingende akronymet <strong>HATEOAS</strong> (Hypertext As The Engine Of Application State). </p><p>Å implementere et ekte RESTful API er ressurskrevende. Det er uklart om steget fra nivå 2 til 3 er verdt den ekstra innsatsen.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="entitetsbasert-api">Entitetsbasert API<a class="hash-link" href="#entitetsbasert-api" title="Direct link to heading">​</a></h3><p>Entitet- eller ressursbasert, som nevnt under nivå 1 under RESTful, handler om å bevege seg bort fra <strong>operasjonen</strong> man skal gjøre og heller se på <strong>data</strong> man skal gjøre noe med. Mange uttrekk og funksjoner i dag er resultatet av at man skal gjøre noe bestemt. Konsumenter trenger sammensatte uttrekk fra konsumenter og skal ikke ha for mye eller for lite data. Dataene skal formateres på bestemte måter og svært sjeldent kan to ulike konsumenter benytte de samme uttrekkene.</p><p>Å si at API-er skal være entitetsbaserte (evt. ressursbaserte) vil si at man heller eksponerer typiske entiteter fra kilden heller enn ferdige uttrekk. Om en konsument trenger informasjon om ansatte og deres organisasjonstilhørighet så kan dette realiseres med entitetene <em>employees</em>og <em>organisational units</em>. Relasjonen mellom den ansatte og organisasjon realiseres som attributter i en eller begge entiteter. Det er opp til eiere, forvaltere og utviklere for en kilde om hva som er en entitet eller ressurs. Eksempelvis kan man si at en brukerkonto er en entitet, mens et brukernavn kun er et attributt ved denne brukerkontoen. En gruppe er en entitet, mens gruppenavnet og medlemskap er attributter til gruppen.</p><p>Slike kolleksjoner av entiteter eller ressurser vil ikke gi den skreddersømmen som vi til vanlig har tilbudt. Det er nå opp til konsumenten å selv filtrere og slå sammen data, men kilden tilbyr nå verktøyene for at konsumenter kan få data. </p><p>For funksjoner som aldri kan være datadrevne –  som start/stopp-funksjonalitet – er det opp til tjenesteeier for hvordan man realiserer dette.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="funksjonelt-api">Funksjonelt API<a class="hash-link" href="#funksjonelt-api" title="Direct link to heading">​</a></h3><p>Et funksjonelt API, til forskjell fra <a href="https://en.wikipedia.org/wiki/Functional_programming" target="_blank" rel="noopener noreferrer">funksjonell programmering</a>, omhandler at designet av API-et skal være forståelig og brukbart for utenforstående. Utviklere av konsumenter sitter ikke med den domenekunnskapen som de som jobber med en kilde gjør. Dette betyr at API-er inn mot kilder bør forenkles slik at de gir mening for utenforstående, men ikke mer enn at informasjon som er nødvendig for konsumenter går tapt.</p><p>Et eksempel kan være den aktive studentmassen på UiO. Ulike konsumenter kan være interessert i ulike mengder studenter slik at API-et må gi et rikt utplukk studenter, men konsumentene vet ikke reglene som omhandler betalt semesteravgift, oppmeldt studieprogram eller enkeltemne, samt andre regler som bestemmer om studenter regnes som &quot;aktive&quot; studenter. API-et kunne realiseres som enten å ha et attributt som sier &quot;aktiv&quot; på ressursen student, eller eksponere alle tilhørende databasestrukturer som avgjør om studenten er aktiv i andre enden av skalaen. Sannsynligvis ligger den beste løsningen et sted i midten, der man bør eksponere mye av de tilhørende data, men på en slik måte at konsumenten kan forstå informasjonen heller enn å lære seg de interne strukturene i kilden.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/jokim/datadelingsdokumentasjon/tree/master/docs/datadeling/god-praksis/bruk-av-webservice.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_foO9"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/datadeling-docs-tmp/docs/datadeling/god-praksis/api-design"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">API-design</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/datadeling-docs-tmp/docs/datadeling/god-praksis/datakvalitet"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Anbefalinger for god datakvalitet</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#hva-er-en-webservicews" class="table-of-contents__link toc-highlight">Hva er en Webservice(WS)?</a></li><li><a href="#hva-er-hensikten" class="table-of-contents__link toc-highlight">Hva er hensikten?</a><ul><li><a href="#dagens-situasjon" class="table-of-contents__link toc-highlight">Dagens situasjon</a></li><li><a href="#en-ws-basert-modell" class="table-of-contents__link toc-highlight">En WS-basert modell</a></li><li><a href="#api-manager" class="table-of-contents__link toc-highlight">API manager</a></li><li><a href="#meldingskø-mq" class="table-of-contents__link toc-highlight">Meldingskø (MQ)</a></li></ul></li><li><a href="#hvem-må-haen-ws" class="table-of-contents__link toc-highlight">Hvem må ha en WS?</a><ul><li><a href="#autoritativ-kilde" class="table-of-contents__link toc-highlight">Autoritativ kilde</a></li><li><a href="#datalager" class="table-of-contents__link toc-highlight">Datalager</a></li></ul></li><li><a href="#hvordan-skalet-api-i-en-ws-se-ut" class="table-of-contents__link toc-highlight">Hvordan skal et API i en WS se ut?</a><ul><li><a href="#restful" class="table-of-contents__link toc-highlight">RESTful</a></li><li><a href="#entitetsbasert-api" class="table-of-contents__link toc-highlight">Entitetsbasert API</a></li><li><a href="#funksjonelt-api" class="table-of-contents__link toc-highlight">Funksjonelt API</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 HK-dir, Unit, Uninett AS</div></div></div></footer></div>
<script src="/datadeling-docs-tmp/assets/js/runtime~main.e4845f73.js"></script>
<script src="/datadeling-docs-tmp/assets/js/main.d6ed1a21.js"></script>
</body>
</html>